<!DOCTYPE html>
<html lang="en" >

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


<meta property="og:title" content="" />
<meta property="og:description" content="安裝與測試 free5GC 核心網路 此示範我們將練習：
 安裝必需工具 安裝 free5GC 測試 free5GC  請注意下面的安裝流程是參考 free5GC 官網文件。
未來 free5GC 若有版本更新而導致部分指令無法運作，請以官網資訊為準。
1. 確定系統版本 先用 uname -r 確定 kernel 版本。若安裝 Ubuntu 20.04, 版本應為 5.4.x。
$ uname -r 5.4.0-65-generic 請確認你的版本為5.0.0-23-generic 或 5.4.0 以後版本。
2. 安裝基本工具 確定沒有安裝 go
go version 若有安裝舊版本，請先刪除 (假設你的 go 是安裝在 /usr/local/go)：
sudo rm -rf /usr/local/go 要安裝最新 Golang, 網路搜尋 ubunto golan install，會得到網址： Download and install" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.free5gc.org/installations/stage-3-free5gc-install-tw/" />




<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=""/>
<meta name="twitter:description" content="安裝與測試 free5GC 核心網路 此示範我們將練習：
 安裝必需工具 安裝 free5GC 測試 free5GC  請注意下面的安裝流程是參考 free5GC 官網文件。
未來 free5GC 若有版本更新而導致部分指令無法運作，請以官網資訊為準。
1. 確定系統版本 先用 uname -r 確定 kernel 版本。若安裝 Ubuntu 20.04, 版本應為 5.4.x。
$ uname -r 5.4.0-65-generic 請確認你的版本為5.0.0-23-generic 或 5.4.0 以後版本。
2. 安裝基本工具 確定沒有安裝 go
go version 若有安裝舊版本，請先刪除 (假設你的 go 是安裝在 /usr/local/go)：
sudo rm -rf /usr/local/go 要安裝最新 Golang, 網路搜尋 ubunto golan install，會得到網址： Download and install"/>
<meta name="generator" content="Hugo 0.79.1" />

    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "",
  "url": "https://www.free5gc.org/installations/stage-3-free5gc-install-tw/",
  "wordCount": "492",
  "datePublished": "0001-01-01T00:00:00+00:00",
  "author": {
    "@type": "Person",
    "name": "free5GC.ofg"
  }
}
</script>



    <link rel="canonical" href="https://www.free5gc.org/installations/stage-3-free5gc-install-tw/">

    <title> | free5GC</title>

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">

    <!-- combined, minified CSS -->
    
    <link href="https://www.free5gc.org/css/bootstrap-icons.0799fcdcc0b7a1f7165b6d7dd1ea2280de895281badebe34845b3691a0910b0a.css" rel="stylesheet">
    
    <link href="https://www.free5gc.org/css/style.d8d3ca46b31f5e445f452e8cbf40915b1bbc4cd870640af474cc10b8b6dfaa22.css" rel="stylesheet">

    <!-- minified base javascript -->
    
    <script defer src="https://www.free5gc.org/js/base.6d4e3026ad8b475550ec72166dad66ce7e1ca14bc425122ad42fef1d9ca82f67.js" crossorigin="anonymous"></script>

    

  </head>

  <body>

    
    <header class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm">
      <p class="h5 my-0 me-md-auto fw-normal">
        <a class="nav-link " href="https://www.free5gc.org">
          <img src="/img/free5GC.png" width="217" height="51">
        </a>
      </p>
      <nav class="btn-group" role="group" aria-label="Basic outlined example">
          
          <a class="btn btn-outline-primary"
             href="/" title="Home">Home</a>
          
        
          
          <a class="btn btn-outline-primary"
             href="/roadmap/" title="Roadmap">Roadmap</a>
          
        
          
          <div id="btn-group-install" class="btn-group" role="group">
            <button type="button"
                    class="btn btn-outline-primary dropdown-toggle active"
                    data-bs-toggle="dropdown" aria-expanded="false">
              Installations
            </button>
            <ul class="dropdown-menu" aria-labelledby="btn-group-install">
              
              <li><a class="dropdown-item"
                     
                     title="Stage 1: Cluster"
                     href="/installations/stage-1-cluster/">Stage 1: Cluster</a></li>
              
              <li><a class="dropdown-item"
                     
                     title="Stage 1: All-in-one"
                     href="/installations/stage-1-all-in-one/">Stage 1: All-in-one</a></li>
              
              <li><a class="dropdown-item"
                     
                     title="Stage 2: Standalone 5G"
                     href="/installations/stage-2-standalone-5g/">Stage 2: Standalone 5G</a></li>
              
              <li><a class="dropdown-item"
                     
                     title="Stage 3: free5GC"
                     href="/installations/stage-3/">Stage 3: free5GC</a></li>
              
            </ul>
          </div>
          
        
          
          <a class="btn btn-outline-primary"
             href="/membership/" title="Membership">Membership</a>
          
        
          
          <a class="btn btn-outline-primary"
             href="/contactus/" title="Contact Us">Contact Us</a>
          
        
          
          <div id="btn-group-more" class="btn-group" role="group">
            <button type="button"
                    class="btn btn-outline-primary dropdown-toggle"
                    data-bs-toggle="dropdown" aria-expanded="false">
              More
            </button>
            <ul class="dropdown-menu" aria-labelledby="btn-group-more">
              
              <li><a class="dropdown-item"
                     target="_blank"
                     title="Download"
                     href="https://github.com/free5gc/free5gc">Download</a></li>
              
              <li><a class="dropdown-item"
                     target="_blank"
                     title="Youtube"
                     href="https://www.youtube.com/channel/UCywP5Acj50GlhSxZTJXlqtw/videos">Youtube</a></li>
              
              <li><a class="dropdown-item"
                     target="_blank"
                     title="free5GC Forum"
                     href="https://forum.free5gc.org/">free5GC Forum</a></li>
              
              <li><a class="dropdown-item"
                     
                     title="History"
                     href="/history/">History</a></li>
              
            </ul>
          </div>
          
        
      </nav>
    </header>
    

    <div class="container-fluid mx-auto" style="max-width: 960px;">

      


<article class="blog-post">
  <header>
    <h2 class="blog-post-title" dir="auto"><a href="https://www.free5gc.org/installations/stage-3-free5gc-install-tw/"></a></h2>
    <p class="blog-post-meta">

</p>
  </header>
  <h1 id="安裝與測試-free5gc-核心網路">安裝與測試 free5GC 核心網路</h1>
<p>此示範我們將練習：</p>
<ul>
<li>安裝必需工具</li>
<li>安裝 free5GC</li>
<li>測試 free5GC</li>
</ul>
<p>請注意下面的安裝流程是參考
<a href="https://github.com/free5gc/free5gc/wiki/Installation">free5GC 官網文件</a>。</p>
<p>未來 free5GC 若有版本更新而導致部分指令無法運作，請以官網資訊為準。</p>
<h2 id="1-確定系統版本">1. 確定系統版本</h2>
<p>先用 <code>uname -r</code> 確定 kernel 版本。若安裝 Ubuntu 20.04, 版本應為 <code>5.4.x</code>。</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">$ uname -r
5.4.0-65-generic
</code></pre></div><p>請確認你的版本為<code>5.0.0-23-generic</code> 或 <code>5.4.0</code> 以後版本。</p>
<h2 id="2-安裝基本工具">2. 安裝基本工具</h2>
<p>確定沒有安裝 go</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">go version
</code></pre></div><p>若有安裝舊版本，請先刪除 (假設你的 go 是安裝在 <code>/usr/local/go</code>)：</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">sudo rm -rf /usr/local/go
</code></pre></div><p>要安裝最新 Golang, 網路搜尋 <code>ubunto golan install</code>，會得到網址：
<a href="https://golang.org/doc/install" target="_blank">
Download and install</a></p>
<p>瀏覽至該網址，請選擇 Linux, 然後得到 &ldquo;Download Go for Linux&rdquo; 框框的
下載連結 (可在框框裡按滑鼠右鍵，複製連結網址)。網址像</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">https://golang.org/dl/go1.15.7.linux-amd64.tar.gz
</code></pre></div><p>有了上述檔案下載網址，安裝步驟如下：</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash"><span style="color:#007020">cd</span> ~
wget https://golang.org/dl/go1.15.7.linux-amd64.tar.gz
sudo tar -C /usr/local -xzf go1.15.7.linux-amd64.tar.gz
</code></pre></div><p>直接貼上下面指令：</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">mkdir -p ~/go/<span style="color:#666">{</span>bin,pkg,src<span style="color:#666">}</span>
<span style="color:#007020">echo</span> <span style="color:#4070a0">&#39;export GOPATH=$HOME/go&#39;</span> &gt;&gt; ~/.bashrc
<span style="color:#007020">echo</span> <span style="color:#4070a0">&#39;export GOROOT=/usr/local/go&#39;</span> &gt;&gt; ~/.bashrc
<span style="color:#007020">echo</span> <span style="color:#4070a0">&#39;export PATH=$PATH:$GOPATH/bin:$GOROOT/bin&#39;</span> &gt;&gt; ~/.bashrc
<span style="color:#007020">echo</span> <span style="color:#4070a0">&#39;export GO111MODULE=auto&#39;</span> &gt;&gt; ~/.bashrc
<span style="color:#007020">source</span> ~/.bashrc
</code></pre></div><p>看 golang 有無下載成功：</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">go version

</code></pre></div><p>接著安裝 MongoDb, 直接貼上：</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">sudo apt -y update
sudo apt -y install mongodb
sudo systemctl start mongodb
</code></pre></div><p>接著安裝其他開發工具, 貼上：</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">sudo apt -y install git gcc g++ cmake autoconf libtool pkg-config libmnl-dev libyaml-dev
go get -u github.com/sirupsen/logrus
</code></pre></div><p>參考影片 <a href="/stage-3-videos-tw/tools-install/" target="_blank">安裝基本工具</a></p>
<h2 id="3-設定網路規則">3. 設定網路規則</h2>
<p>設定網路，貼上:</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">sudo sysctl -w net.ipv4.ip_forward<span style="color:#666">=</span><span style="color:#40a070">1</span>
sudo iptables -t nat -A POSTROUTING -o enp0s3 -j MASQUERADE
sudo systemctl stop ufw
</code></pre></div><p><em>注意:</em> 上面 <code>enp0s3</code> 為核網連到 Data Network (Internet) 的介面，
可以由 <code>ifconfig</code> 及 <code>route</code> 得到。若你的介面名稱不同，請記得改。
另外注意這些網路設定在重新開機後會消失，每次開機後要記得重做。</p>
<p>參考影片 <a href="/stage-3-videos-tw/routing-setup/" target="_blank">設定網路規則</a></p>
<h2 id="4-安裝-free5gc-核心網路">4. 安裝 free5GC 核心網路</h2>
<p>我們直接安裝 3.0.5 版及最新的更新：</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash"><span style="color:#007020">cd</span> ~
git clone --recursive https://github.com/free5gc/free5gc.git
</code></pre></div><p>接著編譯 free5GC:</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash"><span style="color:#007020">cd</span> ~/free5gc
make
</code></pre></div><p>安裝 gtp5g</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash"><span style="color:#007020">cd</span> ~
git clone https://github.com/PrinzOwO/gtp5g.git
<span style="color:#007020">cd</span> gtp5g
make
sudo make install
</code></pre></div><p>並檢查 gtp5g 是否安裝成功：</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">lsmod | grep gtp
</code></pre></div><div class="alert alert-warning">
<p>由於我們測試儘量會使用最新版本，若遇到問題而無法容易解決，我們可以
試試將下載工具的版本退回至之前已知成功的版本。 例如本範例使用的版本
為 <code>eb37b5eabef4f0c4d80eea80fd58d51aef9b3363</code>，而比最新的 gtp5g 版本還舊。</p>
<p>我們可以藉由 <code>git log</code> 來檢視最近的版本，例如：</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">$ git log
commit d1ed954696906dcfe1345282707af853df2e8336 <span style="color:#666">(</span>HEAD -&gt; master, tag: v0.3.0, origin/master, origin/HEAD<span style="color:#666">)</span>
Merge: eb37b5e c5eeb78
Author: Muthuraman Elangovan &lt;76576790+muthuramanecs03g@users.noreply.github.com&gt;
Date:   Fri Feb <span style="color:#40a070">5</span> 18:52:35 <span style="color:#40a070">2021</span> +0800

    Merge pull request <span style="color:#60a0b0;font-style:italic">#17 from PrinzOwO/feature-qer-support</span>

    QER support in gtp5g

commit c5eeb78222011c8264e87cb23131b919dd9f648c <span style="color:#666">(</span>origin/feature-qer-support<span style="color:#666">)</span>
Author: Muthuraman Elangovan &lt;muthuramane.cs03g@g2.nctu.edu.tw&gt;
Date:   Fri Jan <span style="color:#40a070">22</span> 07:03:13 <span style="color:#40a070">2021</span> +0000

    QER support in gtp5g

commit eb37b5eabef4f0c4d80eea80fd58d51aef9b3363 <span style="color:#666">(</span>tag: v0.2.1<span style="color:#666">)</span>
Merge: 09577db 1cc5c30
Author: Yao Wen Chang &lt;hadeschang0322.cs04@g2.nctu.edu.tw&gt;
Date:   Wed Oct <span style="color:#40a070">21</span> 05:11:43 <span style="color:#40a070">2020</span> +0800

    Merge pull request <span style="color:#60a0b0;font-style:italic">#15 from tim-ywliu/master</span>

    Fix bug <span style="color:#007020;font-weight:bold">for</span> finding PDR

commit 1cc5c30140cd2622e134e4344459fd2d69c3e88a
Author: Tim Liu &lt;timliu@nctu.edu.tw&gt;
Date:   Tue Oct <span style="color:#40a070">20</span> 15:20:06 <span style="color:#40a070">2020</span> +0000

    fix bug <span style="color:#007020;font-weight:bold">for</span> finding PDR

</code></pre></div><p>而版本 <code>eb37b5eabef4f0c4d80eea80fd58d51aef9b3363</code> 為 tag 0.2.
要將版本退回到此，可下指令：</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">git checkout eb37b5eabef4f0c4d80eea80fd58d51aef9b3363
</code></pre></div><p>得到一些列印訊息。你可以在 <code>git log</code> 看看：</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">$ git log
commit eb37b5eabef4f0c4d80eea80fd58d51aef9b3363 <span style="color:#666">(</span>HEAD, tag: v0.2.1<span style="color:#666">)</span>
Merge: 09577db 1cc5c30
Author: Yao Wen Chang &lt;hadeschang0322.cs04@g2.nctu.edu.tw&gt;
Date:   Wed Oct <span style="color:#40a070">21</span> 05:11:43 <span style="color:#40a070">2020</span> +0800

    Merge pull request <span style="color:#60a0b0;font-style:italic">#15 from tim-ywliu/master</span>

    Fix bug <span style="color:#007020;font-weight:bold">for</span> finding PDR

commit 1cc5c30140cd2622e134e4344459fd2d69c3e88a
Author: Tim Liu &lt;timliu@nctu.edu.tw&gt;
Date:   Tue Oct <span style="color:#40a070">20</span> 15:20:06 <span style="color:#40a070">2020</span> +0000

    fix bug <span style="color:#007020;font-weight:bold">for</span> finding PDR

commit 09577dbc1aa0388f5008e7f193959685b3b76587
Author: yaowenchang &lt;hadeschang0322.cs04@g2.nctu.edu.tw&gt;
Date:   Mon Oct <span style="color:#40a070">12</span> 17:02:24 <span style="color:#40a070">2020</span> +0800

    Support to Ubuntu 20.04 with kernel version upper than 5.4

</code></pre></div><p>知道現在目錄已回到指定的舊版本。你現在可以 <code>make</code> 來編譯舊的 gtp5g，
並用 <code>sudo make install</code> 來·安裝，但記得先 <code>sudo make uninstall</code>
解除舊的版本。</p>
<p>若要回到最新版，下指令：</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">git checkout master
</code></pre></div><p>並可</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">git pull
</code></pre></div><p>看看是否有更新的版本。</p>
</div>
<p>參考影片 <a href="/stage-3-videos-tw/free5gc-install/" target="_blank">安裝 free5GC</a></p>
<h2 id="5-測試-free5gc">5. 測試 free5GC</h2>
<p>free5GC 提供了一些測試程式，測試一些 5G 核網標準的功能。 先測試基本的
註冊程序：</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash"><span style="color:#007020">cd</span> ~/free5gc
./test.sh TestRegistration
</code></pre></div><p>若最後有 PASS 字眼出現則安裝成功！ 請繼續一一執行下列測試：</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">./test.sh TestRegistration

./test.sh TestGUTIRegistration

./test.sh TestServiceRequest

./test.sh TestXnHandover

./test.sh TestDeregistration

./test.sh TestPDUSessionReleaseRequest

./test.sh TestPaging

./test.sh TestN2Handover

./test.sh TestNon3GPP

./test.sh TestReSynchronisation

./test_ulcl.sh -om <span style="color:#40a070">3</span> TestRegistration
</code></pre></div><p>參考影片 <a href="/stage-3-videos-tw/free5gc-test/" target="_blank">測試 free5GC</a></p>


  

  
  <hr>
  <footer>

  
    <section>
    <h4></h4>
    <nav class="nav sharing-icons">
      <a class="nav-item" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.free5gc.org%2finstallations%2fstage-3-free5gc-install-tw%2f" title="Share on Facebook"><span class="fab fa-facebook-f fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.free5gc.org%2finstallations%2fstage-3-free5gc-install-tw%2f" title="Share on LinkedIn"><span class="fab fa-linkedin-in fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://twitter.com/intent/tweet?url=https%3a%2f%2fwww.free5gc.org%2finstallations%2fstage-3-free5gc-install-tw%2f&amp;text=" title="Tweet this"><span class="fab fa-twitter fa-2x"></span></a>
    </nav>
  </section>


  

  
  </footer>
  

</article> 



      
      <footer class="pt-4 my-md-5 pt-md-5 border-top">
        <div class="row">
          <div class="col-12 col-md">
	    <a href="https://www.free5gc.org"><img class="mb-2" src="/img/free5GC.png" alt="" height="32"></a>
            <small class="d-block mb-1 text-muted">&copy; Copyright January 2019 free5GC.org</small>
            <small class="d-block mb-1 text-muted">All rights reserved.</small>
          </div>
          <div class="col-6 col-md">
            <h5>Contact:</h5>
            <ul class="list-unstyled text-small">
              <li>
                <a class="link-secondary" href="mailto:free5GC.org@gmail.com"
                   target="_self"><span style="text-decoration:underline">free5GC.org@gmail.com</span>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </footer>
      
    </div> <!-- /.container-fluid -->
  </body>

</html>

