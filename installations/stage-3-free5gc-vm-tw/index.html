<!DOCTYPE html>
<html lang="en" >

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


<meta property="og:title" content="" />
<meta property="og:description" content="建立 free5GC VM 及設定網路 此示範我們將練習：
 複製現有 VM，建立一個新的 free5GC VM 設定 free5GC VM 網路環境  參考影片 複製 VM 與設定 IP
1. 檢查現有 VM 開啟 VirtualBox, 確認現有 Ubuntu VM (ubuntu) 可開機執行
 用 SSH 登入, 進入後確認可以連網 確定做過 sudo apt update 及 sudo apt upgrade 關機 sudo shutdown -P now  2. 建立 free5GC VM 先複製新的 VM:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.free5gc.org/installations/stage-3-free5gc-vm-tw/" />




<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=""/>
<meta name="twitter:description" content="建立 free5GC VM 及設定網路 此示範我們將練習：
 複製現有 VM，建立一個新的 free5GC VM 設定 free5GC VM 網路環境  參考影片 複製 VM 與設定 IP
1. 檢查現有 VM 開啟 VirtualBox, 確認現有 Ubuntu VM (ubuntu) 可開機執行
 用 SSH 登入, 進入後確認可以連網 確定做過 sudo apt update 及 sudo apt upgrade 關機 sudo shutdown -P now  2. 建立 free5GC VM 先複製新的 VM:"/>
<meta name="generator" content="Hugo 0.80.0" />

    
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BlogPosting",
  "headline": "",
  "url": "https://www.free5gc.org/installations/stage-3-free5gc-vm-tw/",
  "wordCount": "482",
  "datePublished": "0001-01-01T00:00:00+00:00",
  "author": {
    "@type": "Person",
    "name": "free5GC.ofg"
  }
}
</script>



    <link rel="canonical" href="https://www.free5gc.org/installations/stage-3-free5gc-vm-tw/">

    <title> | free5GC</title>

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">

    <!-- combined, minified CSS -->
    
    <link href="https://www.free5gc.org/css/bootstrap-icons.0799fcdcc0b7a1f7165b6d7dd1ea2280de895281badebe34845b3691a0910b0a.css" rel="stylesheet">
    
    <link href="https://www.free5gc.org/css/style.d8d3ca46b31f5e445f452e8cbf40915b1bbc4cd870640af474cc10b8b6dfaa22.css" rel="stylesheet">

    <!-- minified base javascript -->
    
    <script defer src="https://www.free5gc.org/js/base.6d4e3026ad8b475550ec72166dad66ce7e1ca14bc425122ad42fef1d9ca82f67.js" crossorigin="anonymous"></script>

    

  </head>

  <body>

    
    <header class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm">
      <p class="h5 my-0 me-md-auto fw-normal">
        <a class="nav-link " href="https://www.free5gc.org">
          <img src="/img/free5GC.png" width="217" height="51">
        </a>
      </p>
      <nav class="btn-group" role="group" aria-label="Basic outlined example">
          
          <a class="btn btn-outline-primary"
             href="/" title="Home">Home</a>
          
        
          
          <a class="btn btn-outline-primary"
             href="/roadmap/" title="Roadmap">Roadmap</a>
          
        
          
          <div id="btn-group-install" class="btn-group" role="group">
            <button type="button"
                    class="btn btn-outline-primary dropdown-toggle active"
                    data-bs-toggle="dropdown" aria-expanded="false">
              Installations
            </button>
            <ul class="dropdown-menu" aria-labelledby="btn-group-install">
              
              <li><a class="dropdown-item"
                     
                     title="Stage 1: Cluster"
                     href="/installations/stage-1-cluster/">Stage 1: Cluster</a></li>
              
              <li><a class="dropdown-item"
                     
                     title="Stage 1: All-in-one"
                     href="/installations/stage-1-all-in-one/">Stage 1: All-in-one</a></li>
              
              <li><a class="dropdown-item"
                     
                     title="Stage 2: Standalone 5G"
                     href="/installations/stage-2-standalone-5g/">Stage 2: Standalone 5G</a></li>
              
              <li><a class="dropdown-item"
                     
                     title="Stage 3: free5GC"
                     href="/installations/stage-3/">Stage 3: free5GC</a></li>
              
            </ul>
          </div>
          
        
          
          <a class="btn btn-outline-primary"
             href="/membership/" title="Membership">Membership</a>
          
        
          
          <a class="btn btn-outline-primary"
             href="/contactus/" title="Contact Us">Contact Us</a>
          
        
          
          <div id="btn-group-more" class="btn-group" role="group">
            <button type="button"
                    class="btn btn-outline-primary dropdown-toggle"
                    data-bs-toggle="dropdown" aria-expanded="false">
              More
            </button>
            <ul class="dropdown-menu" aria-labelledby="btn-group-more">
              
              <li><a class="dropdown-item"
                     target="_blank"
                     title="Download"
                     href="https://github.com/free5gc/free5gc">Download</a></li>
              
              <li><a class="dropdown-item"
                     target="_blank"
                     title="Youtube"
                     href="https://www.youtube.com/channel/UCywP5Acj50GlhSxZTJXlqtw/videos">Youtube</a></li>
              
              <li><a class="dropdown-item"
                     target="_blank"
                     title="free5GC Forum"
                     href="https://forum.free5gc.org/">free5GC Forum</a></li>
              
              <li><a class="dropdown-item"
                     
                     title="History"
                     href="/history/">History</a></li>
              
            </ul>
          </div>
          
        
      </nav>
    </header>
    

    <div class="container-fluid mx-auto" style="max-width: 960px;">

      


<article class="blog-post">
  <header>
    <h2 class="blog-post-title" dir="auto"><a href="https://www.free5gc.org/installations/stage-3-free5gc-vm-tw/"></a></h2>
    <p class="blog-post-meta">

</p>
  </header>
  <h1 id="建立-free5gc-vm-及設定網路">建立 free5GC VM 及設定網路</h1>
<p>此示範我們將練習：</p>
<ul>
<li>複製現有 VM，建立一個新的 free5GC VM</li>
<li>設定 free5GC VM 網路環境</li>
</ul>
<p>參考影片 <a href="/stage-3-videos-tw/clone-change-ip/" target="_blank">複製 VM 與設定 IP</a></p>
<h2 id="1-檢查現有-vm">1. 檢查現有 VM</h2>
<p>開啟 VirtualBox, 確認現有 Ubuntu VM (ubuntu) 可開機執行</p>
<ul>
<li>用 SSH 登入, 進入後確認可以連網</li>
<li>確定做過 <code>sudo apt update</code> 及 <code>sudo apt upgrade</code></li>
<li>關機 <code>sudo shutdown -P now</code></li>
</ul>
<h2 id="2-建立-free5gc-vm">2. 建立 free5GC VM</h2>
<p>先複製新的 VM:</p>
<ul>
<li>選取現有 VM (ubuntu) 右方按鈕 / 快照 / 再製</li>
<li>名稱設為 &ldquo;free5gc&rdquo;</li>
<li>MAC 位址原則為：為所有網卡產生新的 MAC 位址</li>
<li>選取連結再製（或先了解完整再製與連結再製的不同，你也可選則完整再製）</li>
</ul>
<p>成功後</p>
<ul>
<li>啟動新建立的 free5gc VM，使用相同帳號登入</li>
<li>用 <code>ping</code> 及 <code>ifconfig</code> 確定連網及 Host-only 介面卡 IP 位址
<ul>
<li>例如 IP 可能為 <code>192.168.56.103</code>, 介面名稱為 <code>enp0s8</code></li>
</ul>
</li>
<li>用 SSH 登入 free5gc 確認可以連線</li>
</ul>
<h2 id="3-更改-hostname">3. 更改 hostname</h2>
<p>複製而來的 VM hostname 仍為 <code>ubuntu</code> （或你之前給的名字）。
我們練習將這台電腦取名為 <code>free5gc</code>。 你可以用 <code>vi</code> 或 <code>nano</code> 編輯 <code>/etc/hostname</code> 檔案：</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">sudo nano /etc/hostname  <span style="color:#60a0b0;font-style:italic"># or sudo vi /etc/hostname</span>
</code></pre></div><p>將檔案裡的 <code>ubuntu</code> 改為 <code>free5gc</code>。若你用 <code>nano</code> 編輯，可以按 Ctrl-O 儲存檔案，再
按 Ctrl-X 離開。</p>
<p>順便將 <code>/etc/hosts</code> 裡的 <code>ubuntu</code> 改成 <code>free5gc</code>:</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">sudo nano /etc/hosts
</code></pre></div><p>新的 <code>/etc/hosts</code> 檔案內容像這樣：</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">127.0.0.1 localhost
127.0.1.1 free5gc

    ...
</code></pre></div><p>等待會重新開機時就會生效。</p>
<h2 id="4-設定靜態-ip-網址">4. 設定靜態 IP 網址</h2>
<p>預設的 Host-only 介面卡是藉由 DHCP 得到 IP 位址。為減少後面指令錯誤的發生，
這裡練習在 Ubuntu 為 Host-only 介面卡設定靜態 IP (將之固定為 <code>192.168.56.101</code>).</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">$ <span style="color:#007020">cd</span> /etc/netplan
$ ls
00-installer-config.yaml
$ cat 00-installer-config.yaml
</code></pre></div><p>原先的檔案內容為:</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash"><span style="color:#60a0b0;font-style:italic"># This is the network config written by &#39;subiquity&#39;</span>
network:
  ethernets:
    enp0s3:
      dhcp4: <span style="color:#007020">true</span>
    enp0s8:
      dhcp4: <span style="color:#007020">true</span>
  version: <span style="color:#40a070">2</span>
</code></pre></div><p>代表 VM 有兩張網路介面卡，由指令 <code>ifconfig</code> 我們得知 <code>enp0s8</code> 為 Host-only 介面卡。你可以
編輯此檔案:</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">sudo nano 00-installer-config.yaml
</code></pre></div><p>新的檔案內容：</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash"><span style="color:#60a0b0;font-style:italic"># This is the network config written by &#39;subiquity&#39;</span>
network:
  ethernets:
    enp0s3:
      dhcp4: <span style="color:#007020">true</span>
    enp0s8:
      dhcp4: no
      addresses: <span style="color:#666">[</span>192.168.56.101/24<span style="color:#666">]</span>
  version: <span style="color:#40a070">2</span>
</code></pre></div><p>先測試是否內容無誤：</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">sudo netplan try
</code></pre></div><p>再套用新的設定</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">sudo netplan apply
</code></pre></div><p>執行 <code>ifconfig</code> 檢查網路設定是否改變：</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">enp0s3: <span style="color:#bb60d5">flags</span><span style="color:#666">=</span>4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span style="color:#40a070">1500</span>
        inet 10.0.2.15  netmask 255.255.255.0  broadcast 10.0.2.255
        inet6 fe80::a00:27ff:fec4:254f  prefixlen <span style="color:#40a070">64</span>  scopeid 0x20&lt;link&gt;
        ether 08:00:27:c4:25:4f  txqueuelen <span style="color:#40a070">1000</span>  <span style="color:#666">(</span>Ethernet<span style="color:#666">)</span>
        RX packets <span style="color:#40a070">2</span>  bytes <span style="color:#40a070">1180</span> <span style="color:#666">(</span>1.1 KB<span style="color:#666">)</span>
        RX errors <span style="color:#40a070">0</span>  dropped <span style="color:#40a070">0</span>  overruns <span style="color:#40a070">0</span>  frame <span style="color:#40a070">0</span>
        TX packets <span style="color:#40a070">18</span>  bytes <span style="color:#40a070">1894</span> <span style="color:#666">(</span>1.8 KB<span style="color:#666">)</span>
        TX errors <span style="color:#40a070">0</span>  dropped <span style="color:#40a070">0</span> overruns <span style="color:#40a070">0</span>  carrier <span style="color:#40a070">0</span>  collisions <span style="color:#40a070">0</span>

enp0s8: <span style="color:#bb60d5">flags</span><span style="color:#666">=</span>4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span style="color:#40a070">1500</span>
        inet 192.168.56.101  netmask 255.255.255.0  broadcast 192.168.56.255
        inet6 fe80::a00:27ff:fe7e:ada6  prefixlen <span style="color:#40a070">64</span>  scopeid 0x20&lt;link&gt;
        ether 08:00:27:7e:ad:a6  txqueuelen <span style="color:#40a070">1000</span>  <span style="color:#666">(</span>Ethernet<span style="color:#666">)</span>
        RX packets <span style="color:#40a070">8420</span>  bytes <span style="color:#40a070">531867</span> <span style="color:#666">(</span>531.8 KB<span style="color:#666">)</span>
        RX errors <span style="color:#40a070">0</span>  dropped <span style="color:#40a070">0</span>  overruns <span style="color:#40a070">0</span>  frame <span style="color:#40a070">0</span>
        TX packets <span style="color:#40a070">10887</span>  bytes <span style="color:#40a070">823487</span> <span style="color:#666">(</span>823.4 KB<span style="color:#666">)</span>
        TX errors <span style="color:#40a070">0</span>  dropped <span style="color:#40a070">0</span> overruns <span style="color:#40a070">0</span>  carrier <span style="color:#40a070">0</span>  collisions <span style="color:#40a070">0</span>

lo: <span style="color:#bb60d5">flags</span><span style="color:#666">=</span>73&lt;UP,LOOPBACK,RUNNING&gt;  mtu <span style="color:#40a070">65536</span>
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen <span style="color:#40a070">128</span>  scopeid 0x10&lt;host&gt;
        loop  txqueuelen <span style="color:#40a070">1000</span>  <span style="color:#666">(</span>Local Loopback<span style="color:#666">)</span>
        RX packets <span style="color:#40a070">6621</span>  bytes <span style="color:#40a070">596035</span> <span style="color:#666">(</span>596.0 KB<span style="color:#666">)</span>
        RX errors <span style="color:#40a070">0</span>  dropped <span style="color:#40a070">0</span>  overruns <span style="color:#40a070">0</span>  frame <span style="color:#40a070">0</span>
        TX packets <span style="color:#40a070">6621</span>  bytes <span style="color:#40a070">596035</span> <span style="color:#666">(</span>596.0 KB<span style="color:#666">)</span>
        TX errors <span style="color:#40a070">0</span>  dropped <span style="color:#40a070">0</span> overruns <span style="color:#40a070">0</span>  carrier <span style="color:#40a070">0</span>  collisions <span style="color:#40a070">0</span>
</code></pre></div><p>檢查 routing table:</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">$ route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         10.0.2.2        0.0.0.0         UG    <span style="color:#40a070">100</span>    <span style="color:#40a070">0</span>        <span style="color:#40a070">0</span> enp0s3
10.0.2.0        0.0.0.0         255.255.255.0   U     <span style="color:#40a070">0</span>      <span style="color:#40a070">0</span>        <span style="color:#40a070">0</span> enp0s3
10.0.2.2        0.0.0.0         255.255.255.255 UH    <span style="color:#40a070">100</span>    <span style="color:#40a070">0</span>        <span style="color:#40a070">0</span> enp0s3
192.168.56.0    0.0.0.0         255.255.255.0   U     <span style="color:#40a070">0</span>      <span style="color:#40a070">0</span>        <span style="color:#40a070">0</span> enp0s8
</code></pre></div><p>可以知道 Host-only 網路 <code>192.168.56.0/24</code> 本身沒有連結到 Internet。(但我們可以
在本機與此 VM 連線)。連結到 Internet 是藉由 NAT 網路 <code>10.0.2.0/24</code>，(gateway
為 <code>10.0.2.2</code>)</p>
<p>現在可以在本機用 SSH 登入 free5gc VM 了。</p>
<div class="highlight"><pre style="background-color:#f0f0f0;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-bash" data-lang="bash">ssh 192.168.56.101 -l ubuntu
</code></pre></div><p>以後和 free5gc 溝通都是藉由 SSH。</p>


  

  
  <hr>
  <footer>

  
    <section>
    <h4></h4>
    <nav class="nav sharing-icons">
      <a class="nav-item" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.free5gc.org%2finstallations%2fstage-3-free5gc-vm-tw%2f" title="Share on Facebook"><span class="fab fa-facebook-f fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.free5gc.org%2finstallations%2fstage-3-free5gc-vm-tw%2f" title="Share on LinkedIn"><span class="fab fa-linkedin-in fa-2x" aria-hidden="true"></span></a>
      <a class="nav-item" href="https://twitter.com/intent/tweet?url=https%3a%2f%2fwww.free5gc.org%2finstallations%2fstage-3-free5gc-vm-tw%2f&amp;text=" title="Tweet this"><span class="fab fa-twitter fa-2x"></span></a>
    </nav>
  </section>


  

  
  </footer>
  

</article> 



      
      <footer class="pt-4 my-md-5 pt-md-5 border-top">
        <div class="row">
          <div class="col-12 col-md">
	    <a href="https://www.free5gc.org"><img class="mb-2" src="/img/free5GC.png" alt="" height="32"></a>
            <small class="d-block mb-1 text-muted">&copy; Copyright January 2019 free5GC.org</small>
            <small class="d-block mb-1 text-muted">All rights reserved.</small>
          </div>
          <div class="col-6 col-md">
            <h5>Contact:</h5>
            <ul class="list-unstyled text-small">
              <li>
                <a class="link-secondary" href="mailto:free5GC.org@gmail.com"
                   target="_self"><span style="text-decoration:underline">free5GC.org@gmail.com</span>
                </a>
              </li>
            </ul>
          </div>
        </div>
      </footer>
      
    </div> <!-- /.container-fluid -->
  </body>

</html>

